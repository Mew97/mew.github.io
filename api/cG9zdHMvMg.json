{"title":"关于nacos搭建与使用","date":"2020-03-10T11:19:13.000Z","date_formatted":{"ll":"2020年3月10日","L":"2020/03/10","MM-DD":"03-10"},"link":"posts/2","comments":true,"updated":"2020-03-12T09:15:49.951Z","content":"<span style=\"font-size: 18px; font-weight: 500\">\n\n<h1 id=\"关于nacos搭建与使用\">关于nacos搭建与使用<a href=\"#关于nacos搭建与使用\" title=\"关于nacos搭建与使用\"></a></h1><ul><li><strong><a href=\"https://nacos.io/zh-cn/\" target=\"_blank\">中文官网</a></strong></li><li><strong><a href=\"https://github.com/nacos-group/nacos-docker.git\" target=\"_blank\">Docker安装官方地址</a></strong></li><li><strong><a href=\"https://github.com/paderlol/nacos-docker\" target=\"_blank\">Docker安装官方地址(中文版)</a></strong></li></ul><h2 id=\"安装\">安装<a href=\"#安装\" title=\"安装\"></a></h2><h3 id=\"推荐docker安装，简单快捷\">推荐Docker安装，简单快捷<a href=\"#推荐docker安装，简单快捷\" title=\"推荐Docker安装，简单快捷\"></a></h3><blockquote>\n<p>环境要求：  </p>\n<ul><li>docker</li><li>docker-compose</li></ul></blockquote>\n<p>上面给的两个版本都可以用，下面介绍第二个版本安装方法  </p>\n<ul><li><strong>Clone 项目 并且进入项目根目录</strong></li></ul><figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git clone https://github.com/paderlol/nacos-docker.git</span><br><span class=\"line\">cd nacos-docker</span><br></pre></td></tr></table></figure>\n\n<ul><li><strong>单机</strong></li></ul><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker<span class=\"literal\">-compose</span> <span class=\"operator\">-f</span> standalone.yaml up</span><br></pre></td></tr></table></figure>\n\n<ul><li><strong>集群</strong></li></ul><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">docker<span class=\"literal\">-compose</span> <span class=\"operator\">-f</span> cluster.yaml up</span><br></pre></td></tr></table></figure>\n\n\n<ul><li><strong>注册服务</strong>(或者直接在项目中的application.yaml里配置)</li></ul><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl <span class=\"literal\">-X</span> PUT <span class=\"string\">'http://127.0.0.1:8848/nacos/v1/ns/instance?serviceName=nacos.naming.serviceName&amp;ip=20.18.7.10&amp;port=8080'</span></span><br></pre></td></tr></table></figure>\n\n<ul><li><strong>注册配置</strong>(或者直接在项目中的application.yaml里配置)</li></ul><figure class=\"highlight powershell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">curl <span class=\"literal\">-X</span> POST <span class=\"string\">\"http://127.0.0.1:8848/nacos/v1/cs/configs?dataId=nacos.cfg.dataId&amp;group=test&amp;content=helloWorld\"</span></span><br></pre></td></tr></table></figure>\n\n<ul><li><p><strong>访问控制台</strong></p><p><strong>浏览器访问：<a href=\"http://127.0.0.1:8848/nacos/\" target=\"_blank\">http://127.0.0.1:8848/nacos/</a></strong><br><strong>初始用户名密码都是 nacos</strong></p></li></ul><h3 id=\"这里直接贴出nacos的docker-compose配置，不想git的朋友直接配置就好\">这里直接贴出nacos的docker-compose配置，不想git的朋友直接配置就好<a href=\"#这里直接贴出nacos的docker-compose配置，不想git的朋友直接配置就好\" title=\"这里直接贴出nacos的docker-compose配置，不想git的朋友直接配置就好\"></a></h3><ul><li><strong>单机版(测试的话这个就好)</strong></li></ul><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"2\"</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">nacos:</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">paderlol/nacos:latest</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">nacos-standalone</span></span><br><span class=\"line\">    <span class=\"attr\">environment:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">PREFER_HOST_MODE=hostname</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">MODE=standalone</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./logs:/home/nacos/logs</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"8848:8848\"</span></span><br></pre></td></tr></table></figure>\n\n<ul><li><strong>集群版(基于mysql主从架构)</strong></li></ul><figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\">version:</span> <span class=\"string\">\"3\"</span></span><br><span class=\"line\"><span class=\"attr\">services:</span></span><br><span class=\"line\">  <span class=\"attr\">nacos1:</span></span><br><span class=\"line\">    <span class=\"attr\">hostname:</span> <span class=\"string\">nacos1</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">nacos1</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">paderlol/nacos:latest</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./logs:/home/nacos/logs</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"8848:8848\"</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"9555:9555\"</span></span><br><span class=\"line\">    <span class=\"attr\">env_file:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/nacos-hostname.env</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">mysql-master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">mysql-slave</span></span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"attr\">nacos2:</span></span><br><span class=\"line\">    <span class=\"attr\">hostname:</span> <span class=\"string\">nacos2</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">paderlol/nacos:latest</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">nacos2</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"8849:8848\"</span></span><br><span class=\"line\">    <span class=\"attr\">env_file:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/nacos-hostname.env</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">mysql-master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">mysql-slave</span></span><br><span class=\"line\">  <span class=\"attr\">nacos3:</span></span><br><span class=\"line\">    <span class=\"attr\">hostname:</span> <span class=\"string\">nacos3</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">paderlol/nacos:latest</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">nacos3</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"8850:8848\"</span></span><br><span class=\"line\">    <span class=\"attr\">env_file:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/nacos-hostname.env</span></span><br><span class=\"line\">    <span class=\"attr\">restart:</span> <span class=\"string\">always</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">mysql-master</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">mysql-slave</span></span><br><span class=\"line\">  <span class=\"attr\">mysql-master:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">mysql-master</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">paderlol/nacos-mysql-master:latest</span></span><br><span class=\"line\">    <span class=\"attr\">env_file:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/mysql-common.env</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/mysql-master.env</span></span><br><span class=\"line\">    <span class=\"attr\">volumes:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">./mysql:/var/lib/mysql</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"3306:3306\"</span></span><br><span class=\"line\">  <span class=\"attr\">mysql-slave:</span></span><br><span class=\"line\">    <span class=\"attr\">container_name:</span> <span class=\"string\">mysql-slave</span></span><br><span class=\"line\">    <span class=\"attr\">image:</span> <span class=\"string\">paderlol/nacos-mysql-slave:latest</span></span><br><span class=\"line\">    <span class=\"attr\">env_file:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/mysql-common.env</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">./env/mysql-slave.env</span></span><br><span class=\"line\">    <span class=\"attr\">ports:</span></span><br><span class=\"line\">    <span class=\"bullet\">-</span> <span class=\"string\">\"3305:3306\"</span></span><br><span class=\"line\">    <span class=\"attr\">depends_on:</span></span><br><span class=\"line\">      <span class=\"bullet\">-</span> <span class=\"string\">mysql-master</span></span><br></pre></td></tr></table></figure>\n\n\n</span>","prev":{"title":"mongoDB安装与pymongo的使用","link":"posts/6"},"next":{"title":"基于Spring Cloud Alibaba构建一个微服务","link":"posts/3"},"plink":"https://mew.wiki.com/posts/2/","toc":[{"id":"关于nacos搭建与使用","title":"关于nacos搭建与使用","index":"1","children":[{"id":"安装","title":"安装","index":"1.1","children":[{"id":"推荐docker安装，简单快捷","title":"推荐Docker安装，简单快捷","index":"1.1.1"},{"id":"这里直接贴出nacos的docker-compose配置，不想git的朋友直接配置就好","title":"这里直接贴出nacos的docker-compose配置，不想git的朋友直接配置就好","index":"1.1.2"}]}]}]}